import {
  $isDecoratorBlockNode
} from "./chunk-SCU3KT72.js";
import {
  useLexicalNodeSelection
} from "./chunk-HMUZ5U3A.js";
import {
  $getNearestBlockElementAncestorOrThrow,
  mergeRegister
} from "./chunk-GVKTXHIP.js";
import {
  $getNodeByKey,
  $getSelection,
  $isNodeSelection,
  $isRangeSelection,
  CLICK_COMMAND,
  COMMAND_PRIORITY_LOW,
  FORMAT_ELEMENT_COMMAND
} from "./chunk-CMQWNATU.js";
import {
  require_jsx_runtime
} from "./chunk-XO4JX7VM.js";
import {
  useLexicalComposerContext
} from "./chunk-LBR27TOC.js";
import {
  require_react
} from "./chunk-PSQR3SVX.js";
import {
  __toESM
} from "./chunk-5WRI5ZAA.js";

// node_modules/@lexical/react/LexicalBlockWithAlignableContents.dev.mjs
var import_react = __toESM(require_react(), 1);
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
function BlockWithAlignableContents({
  children,
  format,
  nodeKey,
  className
}) {
  const [editor] = useLexicalComposerContext();
  const [isSelected, setSelected, clearSelection] = useLexicalNodeSelection(nodeKey);
  const ref = (0, import_react.useRef)(null);
  (0, import_react.useEffect)(() => {
    return mergeRegister(editor.registerCommand(FORMAT_ELEMENT_COMMAND, (formatType) => {
      if (isSelected) {
        const selection = $getSelection();
        if ($isNodeSelection(selection)) {
          const node = $getNodeByKey(nodeKey);
          if ($isDecoratorBlockNode(node)) {
            node.setFormat(formatType);
          }
        } else if ($isRangeSelection(selection)) {
          const nodes = selection.getNodes();
          for (const node of nodes) {
            if ($isDecoratorBlockNode(node)) {
              node.setFormat(formatType);
            } else {
              const element = $getNearestBlockElementAncestorOrThrow(node);
              element.setFormat(formatType);
            }
          }
        }
        return true;
      }
      return false;
    }, COMMAND_PRIORITY_LOW), editor.registerCommand(CLICK_COMMAND, (event) => {
      if (event.target === ref.current) {
        event.preventDefault();
        if (!event.shiftKey) {
          clearSelection();
        }
        setSelected(!isSelected);
        return true;
      }
      return false;
    }, COMMAND_PRIORITY_LOW));
  }, [clearSelection, editor, isSelected, nodeKey, setSelected]);
  return (0, import_jsx_runtime.jsx)("div", {
    className: [className.base, isSelected ? className.focus : null].filter(Boolean).join(" "),
    ref,
    style: {
      textAlign: format ? format : void 0
    },
    children
  });
}
export {
  BlockWithAlignableContents
};
//# sourceMappingURL=@lexical_react_LexicalBlockWithAlignableContents.js.map
